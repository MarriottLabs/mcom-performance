/*
Copyright 2010 Google Inc.
Copyright 2015 Akamai Technolgies

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

See the source code here:
     http://code.google.com/p/episodes/
*/

(function(b){b.parent!==b&&void 0==b.AKSB&&(b=b.parent);var h=b.document;"undefined"===typeof b.AKSB&&(b.AKSB={});var a=b.AKSB;if(void 0!=a.prof&&!0===a.prof.origin&&("number"!==typeof a.prof.beaconrate&&(a.prof.beaconrate=10),parseInt(a.prof.beaconrate,10)<=100*Math.random()))return;a.q=a.q||[];a.targetOrigin=h.location.protocol+"//"+h.location.hostname;a.testObject=a.testObject||"AkamaiSiteBeaconTestObject0123456789.txt";a.autorun="undefined"!==typeof a.autorun?a.autorun:!0;a.version||"X"===b.AKSB.prof.akTT||
(a.version=3,a.init=function(){a.bDone=!1;a.marks={};a.measures={};a.starts={};a.getClientProf();a.findStartTime();a.addEventListener("DOMContentLoaded",a.onready,!1);a.addEventListener("load",a.onload,!1);"complete"===h.readyState&&(a.onloadHasFired=!0,window.setTimeout(a.onload,1));a.processQ()},a.processQ=function(){for(var c=a.q.length,b=0;b<c;b++){var e=a.q[b],f=e[0];"mark"===f?a.mark(e[1],e[2]):"measure"===f?a.measure(e[1],e[2],e[3]):"done"===f&&a.done(e[1])}},a.getClientProf=function(){a.prof=
a.prof||{};a.prof.beaconUrl=a.prof.beaconUrl||("https:"===h.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/2/"+a.prof.custid+"/b";a.prof.ua=escape(b.navigator.userAgent);a.prof.plat=escape(b.navigator.platform);a.prof.uri=escape(h.location.protocol.toLowerCase()+"//"+h.location.hostname.toLowerCase()+h.location.pathname);var c=b.navigator.connection||b.navigator.mozConnection||b.navigator.webkitConnection,d="",e=0;c&&"number"===typeof c.type?c.type==c.WIFI?(d="wifi",e=7E6):c.type==
c.CELL_2G?(d="cellular",e=384):c.type==c.CELL_3G?(d="cellular",e=42E3):c.type==c.CELL_4G?(d="cellular",e=1E5):c.type==c.ETHERNET?(d="ethernet",e=1E7):c.type==c.NONE?(d="none",e=0):d="unknown":c&&"string"===typeof c.type&&(d=c.type,c.downlinkMax&&(e=Math.round(1E3*c.downlinkMax)));a.prof.connType=escape(d);a.prof.connBandwidth=e;a.prof.pageViz=h.visibilityState||h.webkitVisibilityState||h.mozVisibilityState||h.msVisibilityState;a.prof.feo="undefined"!==typeof b.aFeoApplied?!0:!1;a.prof.qryTrunc=""!==
h.location.search;!a.prof.pct||parseInt(a.prof.pct,10)<=100*Math.random()||void 0===a.prof.clientip||(c=a.getMangledAddress(),a.prof.beaconUrl=("https:"===h.location.protocol?"https:":"http:")+"//"+(a.prof.ipv6?"j":"i")+c+"-ds-aksb-a.akamaihd.net/2/"+a.prof.custid+"/b")},a.getMangledAddress=function(){if(void 0===a.prof.clientip)return"";if(a.prof.ipv6){var c=a.prof.clientip.split(":");return(""==c[0]?"":parseInt(c[0],16).toString(32))+"z"+(""==c[1]?"":parseInt(c[1],16).toString(32))+"z"+(""==c[2]?
"":parseInt(c[2],16).toString(32))}c=a.prof.clientip.split(".");return("00000000"+(256*(256*(256*+c[0]+ +c[1])+ +c[2])+0).toString(16)).slice(-8)},a.mark=function(c,b){c&&(a.marks[c]=parseInt(b||(new Date).getTime(),10),"firstbyte"===c?a.measure("t_fb","starttime","firstbyte"):"onload"===c?a.measure("t_onload","starttime","onload"):"done"===c&&a.measure("t_plt","starttime","done"))},a.measure=function(c,b,e){if(c){if("undefined"===typeof b)b="number"===typeof a.marks[c]?a.marks[c]:(new Date).getTime();
else if("number"===typeof a.marks[b])b=a.marks[b];else if("number"!==typeof b)return;if("undefined"===typeof e)e=(new Date).getTime();else if("number"===typeof a.marks[e])e=a.marks[e];else if("number"!==typeof e)return;a.starts[c]=parseInt(b,10);a.measures[c]=parseInt(e-b,10)}},a.done=function(c){a.mark("done");var d=function(){a.bDone=!0;a.autorun&&a.sendBeacon();"function"===typeof c&&c()};if(a.prof.navTimingSupported){var e=a.getNavTimingAPI(),f=e.navigation,l=e.timing,p=function(){if(f&&(0===
f.type||1===f.type)&&l&&0<l.loadEventEnd){for(var c in l)a.mark(c,l[c]);a.measure("dE","domainLookupStart","domainLookupEnd");a.measure("cS","domainLookupStart","connectStart");l.secureConnectionStart&&a.measure("sS","domainLookupStart","secureConnectionStart");a.measure("cE","domainLookupStart","connectEnd");a.measure("rqS","domainLookupStart","requestStart");a.measure("rsS","domainLookupStart","responseStart");a.measure("rsE","domainLookupStart","responseEnd");l.msFirstPaint?a.measure("fp","navigationStart",
"msFirstPaint"):"undefined"!==typeof b.chrome&&b.chrome.hasOwnProperty("loadTimes")&&a.measure("fp","domainLookupStart",Math.round(1E3*b.chrome.loadTimes().firstPaintTime));a.measure("dl","domainLookupStart","domLoading");a.measure("di","domainLookupStart","domInteractive");a.measure("dlS","domainLookupStart","domContentLoadedEventStart");a.measure("dlE","domainLookupStart","domContentLoadedEventEnd");a.measure("dc","domainLookupStart","domComplete");a.measure("leS","domainLookupStart","loadEventStart");
a.measure("leE","domainLookupStart","loadEventEnd");d()}else 0>=l.loadEventEnd&&setTimeout(p,100)};p()}else d()},a.aksbVersion=function(){return""+(void 0===a.prof.blver?0:a.prof.blver)+":"+(void 0===a.version?0:a.version)},a.sendBeacon=function(b,d){b=b||a.prof.beaconUrl;var e="";a.bf=a.bitField();a.createBitField();var f={dE:a.measures.dE,cS:a.measures.cS,cE:a.measures.cE,rqS:a.measures.rqS,rsS:"undefined"!==typeof a.measures.rsS?a.measures.rsS:a.measures.t_fb,rsE:a.measures.rsE,sS:a.measures.sS,
dl:a.measures.dl,di:a.measures.di,fp:a.measures.fp,dlS:a.measures.dlS,dlE:"undefined"!==typeof a.measures.dlE?a.measures.dlE:a.measures.t_onready,dc:a.measures.dc,leS:"undefined"!==typeof a.measures.leS?a.measures.leS:a.measures.t_onload,leE:"undefined"!==typeof a.measures.leE?a.measures.leE:a.measures.t_plt,to:a.measures.to,ol:a.prof.originlat,cr:a.prof.clientrtt,mt:a.prof.connType,mb:a.prof.connBandwidth,b:a.bf.get(),u:a.prof.uri,ua:a.prof.ua,pl:a.prof.plat,us:a.prof.ustr,gh:a.prof.ghostip,t:a.prof.token,
rid:a.prof.requestid,akM:a.prof.akM,akN:a.prof.akN,vc:a.aksbVersion(),bpcip:a.getMangledAddress(),akTX:a.prof.akTX,akTI:a.prof.akTI},l;for(l in f)e+="&"+escape(l)+"="+("undefined"===typeof f[l]?"":f[l]);if(e){e=e.substring(1);if(d)for(var p in d)d.hasOwnProperty(p)&&(e+="&"+escape(p)+"="+escape(d[p]));a.bf.get();f=new Image;f.src=b+"?"+e;return f.src}return""},a.bitField=function(a){var b=Math.abs(a);a=function(){};a.prototype.set=function(a){return this.hasbit(a)?b:b|=a};a.prototype.hasbit=function(a){return a>
b?0:b&a};a.prototype.get=function(){return b};return new a},a.createBitField=function(){"nt"===a.prof.src&&a.bf.set(1);"js"===a.prof.src&&a.bf.set(2);"gtb"===a.prof.src&&a.bf.set(8);var c=a.prof.protocol;void 0!==c&&("h2"==c.slice(0,2)?a.bf.set(131072):"spdy"==c.slice(0,4)&&a.bf.set(64));a.prof.ipv6&&a.bf.set(16);a.prof.feo&&a.bf.set(32);"hidden"===a.prof.pageViz&&a.bf.set(128);"visible"===a.prof.pageViz&&a.bf.set(256);"prerendered"===a.prof.pageViz&&a.bf.set(512);a.prof.qryTrunc&&a.bf.set(2048);
!0===a.prof.origin&&a.bf.set(4096);!0===a.onloadHasFired&&a.bf.set(8192);b.performance&&(b.performance.getEntries||b.performance.webkitGetEntries)||a.bf.set(16384);a.prof.akTT&&"O"!=a.prof.akTT&&a.bf.set(262144)},a.findStartTime=function(){a.processQ();var b=a.findStartWebTiming()||a.findStartGToolbar();!b&&a.marks.firstbyte&&(b=a.marks.firstbyte,a.prof.src="js");b&&a.mark("starttime",b)},a.findStartWebTiming=function(){var b=void 0,d=a.getNavTimingAPI();"undefined"!==typeof d&&"undefined"!==typeof d.timing&&
"undefined"!==typeof d.timing.navigationStart&&(a.prof.navTimingSupported=!0,b=a.prof.ua.match(/Firefox\/[78]\./i)?d.timing.unloadEventStart||d.timing.fetchStart:d.timing.navigationStart,a.prof.src="nt");return b},a.findStartGToolbar=function(){var c=void 0;"undefined"!==typeof b.external&&"undefined"!==typeof b.external.pageT?c=(new Date).getTime()-b.external.pageT:"undefined"!==typeof b.gtbExternal&&"undefined"!==typeof b.gtbExternal.pageT?c=(new Date).getTime()-window.gtbExternal.pageT():"undefined"!==
typeof b.chrome&&"undefined"!==typeof b.chrome.csi&&(c=(new Date).getTime()-b.chrome.csi().pageT);c&&(a.prof.src="gtb");return c},a.onready=function(b){a.mark("onready",(new Date).getTime());a.measure("t_onready","starttime","onready")},a.onload=function(b){a.mark("onload",(new Date).getTime());a.autorun&&a.done()},a.addEventListener=function(a,d,e){if("undefined"!==typeof b.attachEvent)return b.attachEvent("on"+a,d);if(b.addEventListener)return b.addEventListener(a,d,e)},a.getNavTimingAPI=function(){return b.performance||
b.mozPerformance||b.msPerformance||b.webkitPerformance},a.init())})(window);
(function(b){function h(){this.data={};this.value=[]}b.parent!==b&&void 0==b.RT&&(b=b.parent);var a=b.document;"undefined"===typeof b.RT&&(b.RT={});var c=b.RT;if(!c.version&&"undefined"!==typeof b.AKSB.version&&void 0!==Object.keys){c.version="0.2";c.init=function(){"complete"===a.readyState?window.setTimeout(c.getW3CTimings,1):c.addEventListener("load",c.getW3CTimings,!1)};c.getW3CTimings=function(){var e=new h,f=c.getResourceTimingAPI(),l={},d=0;if("all"in b.document)for(var q=b.document.all,k=
0;k<q.length;k++){var m=q[k];if("LINK"===m.tagName&&"href"in m){if("http"===m.href.substr(0,4).toLowerCase()&&(l[m.href]=1,1E3<d++))break}else if("src"in m&&"http"===m.src.substr(0,4).toLowerCase()&&(l[m.src]=1,1E3<d++))break}if(f)for(k in f)"undefined"!==typeof f[k].duration&&(delete l[f[k].name],e.insert(f[k].name,[Math.round(f[k].redirectStart),Math.round(f[k].redirectEnd),Math.round(f[k].fetchStart),Math.round(f[k].domainLookupStart),Math.round(f[k].domainLookupEnd),Math.round(f[k].connectStart),
Math.round(f[k].connectEnd),Math.round(f[k].secureConnectionStart),Math.round(f[k].requestStart),Math.round(f[k].responseStart),Math.round(f[k].responseEnd),Math.round(f[k].duration),f[k].initiatorType,f[k].nextHopProtocol,f[k].transferSize,f[k].encodedBodySize,f[k].decodedBodySize]));for(res in l)e.insert(res,[]);c.radtree=e;c.baseurl=escape(a.location.protocol.toLowerCase()+"//"+a.location.hostname.toLowerCase()+a.location.pathname);var n=function(a){var e=new XMLHttpRequest;e.open("POST",("https:"===
b.document.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/RRT",!0);e.send(JSON.stringify([a,c.radtree.data,b.AKSB.prof.requestid,b.AKSB.prof.ghostip,b.AKSB.bf.get(),b.AKSB.prof.custid,b.AKSB.prof.ustr,b.AKSB.prof.originlat,b.AKSB.prof.clientrtt,b.AKSB.prof.ua,b.AKSB.prof.plat,b.AKSB.prof.connType,b.AKSB.prof.connBandwidth,b.AKSB.aksbVersion(),b.AKSB.getMangledAddress(),b.AKSB.akTX,b.AKSB.akTI]))};if(b.performance&&b.performance.timing){var g=b.performance.timing,r=function(){if(0<g.loadEventEnd){var a=
[g.domainLookupEnd-g.domainLookupStart,g.connectStart-g.domainLookupStart,g.connectEnd-g.domainLookupStart,g.secureConnectionStart?g.secureConnectionStart-g.domainLookupStart:null,g.requestStart-g.domainLookupStart,g.responseStart-g.domainLookupStart,g.responseEnd-g.domainLookupStart,g.domLoading-g.domainLookupStart,g.domInteractive-g.domainLookupStart,g.msFirstPaint?g.msFirstPaint-g.navigationStart:"undefined"!==typeof b.chrome&&b.chrome.hasOwnProperty("loadTimes")?Math.round(1E3*b.chrome.loadTimes().firstPaintTime)-
g.domainLookupStart:null,g.domContentLoadedEventStart-g.domainLookupStart,g.domContentLoadedEventEnd-g.domainLookupStart,g.domComplete-g.domainLookupStart,g.loadEventStart-g.domainLookupStart,g.loadEventEnd-g.domainLookupStart],e={};e[c.baseurl]=a;n(e)}else 0>=g.loadEventEnd&&setTimeout(r,100)};r()}else{var s=function(){if("AKSB"in b&&"measures"in b.AKSB&&"t_plt"in b.AKSB.measures){var a={};a[c.baseurl]=[null,null,null,0,null,null,null,null,null,null,null,null,null,b.AKSB.measures.t_onload,b.AKSB.measures.t_plt];
n(a)}else setTimeout(s,100)};s()}};c.addEventListener=function(a,c,d){if("undefined"!==typeof b.attachEvent)return b.attachEvent("on"+a,c);if(b.addEventListener)return b.addEventListener(a,c,d)};c.getResourceTimingAPI=function(){if("performance"in b){if("getEntriesByType"in b.performance)return b.performance.getEntriesByType("resource");if("webkitGetEntriesByType"in b.performance)return b.performance.webkitGetEntriesByType("resource")}return null};h.prototype.insert=function(a,b){for(var c=this.data;a;){var d=
this.get_prefix(a,Object.keys(c)),h=d[0],d=d[1];if(!h||"string"!==typeof h||"string"!==typeof d)break;var k=h.length;if(h!==d){var m=d.slice(k,d.length),n=c[d];n===this.value&&(n=JSON.parse(JSON.stringify(n)));c[h]={};c[h][m]=n;delete c[d]}else c[h]===this.value&&(c[h]=JSON.parse(JSON.stringify(this.value)));a=a.slice(k,a.length);c=c[h]}c[a]=a?b:null;return!0};h.prototype.get_prefix=function(a,b){function c(a,b){if(""===b)return!0;if(null==a||null==b)return!1;a=String(a);b=String(b);return a.length>=
b.length&&a.slice(0,b.length)===b}b.sort(function(a,b){return a.length<b.length?-1:a.length>b.length?1:0}).reverse;if("undefined"!==typeof a){wc=a[0];for(var d in b)if(c(b[d],wc))for(var h=a.length;1<=h;h--)if(c(b[d],a.slice(0,h)))return[a.slice(0,h),b[d]]}return["",null]};var d=b.AKSB.prof.akTT;"R"===d?c.init():"O"!==d&&void 0!==d||!(0<=b.document.location.search.search("akamai-rum-rt=on"))&&10<=100*Math.random()||c.init()}})(window);
