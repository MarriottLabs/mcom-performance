(function(){window.STR==null&&(window.STR={}),STR.UuidSync||(STR.UuidSync={Helpers:{}})}).call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};STR.UuidSync.Helpers.BlueKaiHelpers=function(){function n(){this.expireTimeout=e(this.expireTimeout,this),this.startTimeout=e(this.startTimeout,this),this.callbacks=[],this.defineUidReadyCallback(),this.startTimeout(),this.dropJS()}var t;return n.prototype.WAIT_THRESHOLD=2e3,n.prototype.STR_CALLBACK_NAME="STRBKCallback",n.init=function(){var e;return e=new this},n.prototype.whenUidReady=function(e){return this.status!=null?e(this.uid,this.status):this.callbacks.push(e)},n.prototype.defineUidReadyCallback=function(){return window[this.STR_CALLBACK_NAME]=function(e){return function(t){var n,r;if(!e.status)return window.clearTimeout(e.timeoutID),r=new STR.UuidSync.Helpers.BlueKaiResponseParser,n=r.getUid(t),n!=null?e.setUid(n,"valid"):e.setUid("","not_available")}}(this)},n.prototype.startTimeout=function(){return this.timeoutID=window.setTimeout(this.expireTimeout,this.WAIT_THRESHOLD)},n.prototype.dropJS=function(){var e,n;return n=document.createElement("script"),n.src=t(this.STR_CALLBACK_NAME),e=document.getElementsByTagName("head")[0],e.appendChild(n)},n.prototype.setUid=function(e,t){var n,r,i,s,o;this.uid=e,this.status=t,s=this.callbacks,o=[];for(r=0,i=s.length;r<i;r++)n=s[r],o.push(n(this.uid,this.status));return o},n.prototype.expireTimeout=function(){return this.setUid("","expired",[])},t=function(e){var t;return t="//tags.bluekai.com/site/20087",""+t+"?ret=js&jscb="+e},n}()}.call(this),function(){STR.UuidSync.Helpers.BlueKaiResponseParser=function(){function n(){}var e,t;return n.prototype.getUid=function(n){var r,i,s,o,u;s=null,i=e(n);for(o=0,u=i.length;o<u;o++){r=i[o],s=t(r);if(s!=null)break}return s},t=function(e){if(e.STBKUUID!=null)return e.STBKUUID},e=function(e){return(e!=null?e.campaigns:void 0)||[]},n}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};STR.UuidSync.Helpers.CookieSyncHelper=function(){function n(){this.blueKaiCallback=e(this.blueKaiCallback,this);var n;t=STR.UuidSync.Helpers.HtmlUtility.getParameterByName("endpoint");if(t===!1){console.log("End point not specified, should be uuid-sync.js?endpoint='http://your_encoded_end_point_here'");return}n=new STR.UuidSync.Helpers.BlueKaiHelpers,n.whenUidReady(this.blueKaiCallback)}var t;return t="",n.prototype.blueKaiCallback=function(e,n){var r;if(n!=="not_available")return r=new Image,r.src=t.replace("{sharethrough_id}",e),r;console.log("Bluekai user not present")},n}()}.call(this),function(){STR.UuidSync.Helpers.HtmlUtility={getParameterByName:function(e){var t,n;return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(this.getQueryString()),n===null||n==="false"?n=!1:decodeURIComponent(n[1].replace(/\+/g," "))==="true"?n=!0:decodeURIComponent(n[1].replace(/\+/g," "))==="false"||decodeURIComponent(n[1].replace(/\+/g," "))==="0"?n=!1:n=decodeURIComponent(n[1].replace(/\+/g," ")),n},getQueryString:function(){var e,t,n,r;t=document.getElementsByTagName("script");for(n=0,r=t.length;n<r;n++){e=t[n];if(e.src.indexOf("uuid-sync.js")>-1)return"?"+e.src.split("?")[1]}return null}}}.call(this),document.addEventListener&&document.addEventListener("DOMContentLoaded",function(){new STR.UuidSync.Helpers.CookieSyncHelper});